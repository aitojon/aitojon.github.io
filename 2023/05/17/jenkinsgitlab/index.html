

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="AitoJon">
  <meta name="keywords" content="aitojon">
  
    <meta name="description" content="准备工作1、关闭selinux和防火墙1234567[root@jenkins ~]# sed -i &amp;#x27;s&#x2F;enforcing&#x2F;disabled&#x2F;&amp;#x27; &#x2F;etc&#x2F;selinux&#x2F;config #关闭seLinux或[root@jenkins ~]sed -ri &amp;#x27;&#x2F;^[^#]*SELINUX&#x3D;&#x2F;s#&#x3D;.+$#&#x3D;disabled#&amp;#x27; &#x2F;etc&#x2F;selinux&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="Jenkins+gitlab部署参考过程">
<meta property="og:url" content="http://www.aitojon.com/2023/05/17/jenkinsgitlab/index.html">
<meta property="og:site_name" content="AitoJon">
<meta property="og:description" content="准备工作1、关闭selinux和防火墙1234567[root@jenkins ~]# sed -i &amp;#x27;s&#x2F;enforcing&#x2F;disabled&#x2F;&amp;#x27; &#x2F;etc&#x2F;selinux&#x2F;config #关闭seLinux或[root@jenkins ~]sed -ri &amp;#x27;&#x2F;^[^#]*SELINUX&#x3D;&#x2F;s#&#x3D;.+$#&#x3D;disabled#&amp;#x27; &#x2F;etc&#x2F;selinux&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.aitojon.com/img/in/jenkinsin.jpg">
<meta property="article:published_time" content="2023-05-17T10:00:00.000Z">
<meta property="article:modified_time" content="2023-05-22T08:41:58.971Z">
<meta property="article:author" content="AitoJon">
<meta property="article:tag" content="运维">
<meta property="article:tag" content="Jenkins">
<meta property="article:tag" content="gitlab">
<meta property="article:tag" content="部署">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://www.aitojon.com/img/in/jenkinsin.jpg">
  
  
  
  <title>Jenkins+gitlab部署参考过程 - AitoJon</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.aitojon.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":100,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>AitoJon</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                <span>文章</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/archives/">
                    <i class="iconfont icon-archive-fill"></i>
                    <span>归档</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/categories/">
                    <i class="iconfont icon-category-fill"></i>
                    <span>分类</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/tags/">
                    <i class="iconfont icon-tags-fill"></i>
                    <span>标签</span>
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/resume/">
                <i class="iconfont icon-bookmark-fill"></i>
                <span>简历</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Jenkins+gitlab部署参考过程"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-05-17 18:00" pubdate>
          2023年5月17日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          66 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Jenkins+gitlab部署参考过程</h1>
            
            
              <div class="markdown-body">
                
                <hr>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h3 id="1、关闭selinux和防火墙"><a href="#1、关闭selinux和防火墙" class="headerlink" title="1、关闭selinux和防火墙"></a>1、关闭selinux和防火墙</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]# sed -i &#x27;s/enforcing/disabled/&#x27; /etc/selinux/config #关闭seLinux<br>或[root@jenkins ~]sed -ri &#x27;/^[^#]*SELINUX=/s#=.+$#=disabled#&#x27; /etc/selinux/config #关闭seLinux<br>[root@jenkins ~]# systemctl stop firewalld  <br>[root@jenkins ~]# systemctl disable firewalld  #关闭防火墙<br>Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.<br>Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.<br>[root@jenkins ~]#reboot  #重启系统<br></code></pre></td></tr></table></figure>

<p>或者防火墙设置，开启gitlab和Jenkins要用的端口和http服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo firewall-cmd --permanent --add-service=http<br>sudo firewall-cmd --permanent --add-service=https<br>sudo firewall-cmd --permanent --zone=public --add-port=80/tcp<br>sudo firewall-cmd --permanent --zone=public --add-port=8080/tcp<br>sudo firewall-cmd --reload<br></code></pre></td></tr></table></figure>

<h3 id="2、安装依赖包-（Jenkins和gitlab都装）"><a href="#2、安装依赖包-（Jenkins和gitlab都装）" class="headerlink" title="2、安装依赖包 （Jenkins和gitlab都装）"></a>2、安装依赖包 （Jenkins和gitlab都装）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]yum -y install policycoreutils policycoreutils-python openssh-server openssh-clients postfix<br></code></pre></td></tr></table></figure>

<h1 id="一、开始Jenkins安装配置"><a href="#一、开始Jenkins安装配置" class="headerlink" title="一、开始Jenkins安装配置"></a>一、开始Jenkins安装配置</h1><h3 id="1、Java包安装"><a href="#1、Java包安装" class="headerlink" title="1、Java包安装"></a>1、Java包安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">卸载以前旧的Java 安装Java-11版本的<br>[root@jenkins ~]yum remove  java*   -y  <br>[root@jenkins ~]yum install fontconfig java-11-openjdk  -y<br></code></pre></td></tr></table></figure>

<h3 id="2、安装Jenkins"><a href="#2、安装Jenkins" class="headerlink" title="2、安装Jenkins"></a>2、安装Jenkins</h3><p>华为云下载稳定版或者阿里云下载都可以</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">阿里云Jenkins下载<br> [root@jenkins ~]wget https://mirrors.aliyun.com/jenkins/redhat-stable/jenkins-2.346.3-1.1.noarch.rpm<br><br>华为云Jenkins下载<br> [root@jenkins ~]wget  https://repo.huaweicloud.com/jenkins/redhat-stable/jenkins-2.346.3-1.1.noarch.rpm<br></code></pre></td></tr></table></figure>

<p>安装Jenkins</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]ls<br>anaconda-ks.cfg  jenkins-2.346.3-1.1.noarch.rpm<br>[root@jenkins ~]rpm -ivh   jenkins-2.346.3-1.1.noarch.rpm<br>警告：jenkins-2.346.3-1.1.noarch.rpm: 头V4 RSA/SHA512 Signature, 密钥 ID 45f2c3d5: NOKEY<br>准备中...                          ################################# [100%]<br>正在升级/安装...<br>   1:jenkins-2.346.3-1.1              ################################# [100%]<br></code></pre></td></tr></table></figure>

<h3 id="3、启动Jenkins服务"><a href="#3、启动Jenkins服务" class="headerlink" title="3、启动Jenkins服务"></a>3、启动Jenkins服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]#systemctl start jenkins.service<br>[root@jenkins ~]# systemctl status jenkins.service   #看Jenkins启动状态<br>● jenkins.service - Jenkins Continuous Integration Server<br>   Loaded: loaded (/usr/lib/systemd/system/jenkins.service; disabled; vendor preset: disabled)<br>   Active: active (running) since 三 2023-05-17 11:13:01 CST; 9s ago<br> Main PID: 8411 (java)<br>   CGroup: /system.slice/jenkins.service<br>           └─8411 /usr/bin/java -Djava.awt.headless=true -jar /usr/share/java/jenkins.war --webroot=%C/jenk...<br><br>5月 17 11:12:43 jenkins jenkins[8411]: This may also be found at: /var/lib/jenkins/secrets/initialAdmi...word<br>5月 17 11:12:43 jenkins jenkins[8411]: *************************************************************<br>5月 17 11:12:43 jenkins jenkins[8411]: *************************************************************<br>5月 17 11:12:43 jenkins jenkins[8411]: *************************************************************<br>5月 17 11:13:01 jenkins jenkins[8411]: 2023-05-17 03:13:01.937+0000 [id=30]        INFO        jenkins...tion<br>5月 17 11:13:01 jenkins jenkins[8411]: 2023-05-17 03:13:01.991+0000 [id=22]        INFO        hudson....ning<br>5月 17 11:13:01 jenkins systemd[1]: Started Jenkins Continuous Integration Server.<br>5月 17 11:13:03 jenkins jenkins[8411]: 2023-05-17 03:13:03.249+0000 [id=45]        INFO        h.m.Dow...ller<br>5月 17 11:13:03 jenkins jenkins[8411]: 2023-05-17 03:13:03.249+0000 [id=45]        INFO        hudson....t #1<br>5月 17 11:13:03 jenkins jenkins[8411]: 2023-05-17 03:13:03.251+0000 [id=45]        INFO        hudson....2 ms<br>Hint: Some lines were ellipsized, use -l to show in full.<br></code></pre></td></tr></table></figure>

<h3 id="4、修改jenkins配置文件"><a href="#4、修改jenkins配置文件" class="headerlink" title="4、修改jenkins配置文件"></a>4、修改jenkins配置文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">将默认Jenkins用户名修改用户名为root 不改的话后期Jenkins目录没有权限<br>[root@jenkins ~]#vim /etc/sysconfig/jenkins<br>JENKINS_USER=&quot;root&quot;<br><br>[root@jenkins ~]#vim /usr/lib/systemd/system/jenkins.service<br>User=jenkins   改为root<br>Group=jenkins  改为root<br><br>如果想改Jenkins的端口号在这改<br>Environment=&quot;JENKINS_PORT=8080&quot;   将8080端口更改其他的<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">更改完成后加载下配置文件重启Jenkins服务</span><br></code></pre></td></tr></table></figure>

<h3 id="5、重启Jenkins服务-查看端口是否起来"><a href="#5、重启Jenkins服务-查看端口是否起来" class="headerlink" title="5、重启Jenkins服务 查看端口是否起来"></a>5、重启Jenkins服务 查看端口是否起来</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]# systemctl daemon-reload<br>[root@jenkins ~]# systemctl restart jenkins.service<br>[root@jenkins ~]# ss -ntulp<br>Netid  State      Recv-Q Send-Q       Local Address:Port                      Peer Address:Port              <br>udp    UNCONN     0      0                127.0.0.1:323                                  *:*                   users:((&quot;chronyd&quot;,pid=678,fd=5))<br>udp    UNCONN     0      0                    [::1]:323                               [::]:*                   users:((&quot;chronyd&quot;,pid=678,fd=6))<br>tcp    LISTEN     0      128                      *:22                                   *:*                   users:((&quot;sshd&quot;,pid=8275,fd=3))<br>tcp    LISTEN     0      100              127.0.0.1:25                                   *:*                   users:((&quot;master&quot;,pid=1215,fd=13))<br>tcp    LISTEN     0      50                    [::]:8080                              [::]:*                   users:((&quot;java&quot;,pid=8557,fd=109))<br>tcp    LISTEN     0      128                   [::]:22                                [::]:*                   users:((&quot;sshd&quot;,pid=8275,fd=4))<br>tcp    LISTEN     0      100                  [::1]:25                                [::]:*                   users:((&quot;master&quot;,pid=1215,fd=14))<br>[root@jenkins ~]# ps -aux | grep jenkins  ##查看Jenkins路径服务已经为root下 <br>root       8557  9.0 21.1 4861092 1687124 ?     Ssl  11:17   0:16 /usr/bin/java -Djava.awt.headless=true -jar /usr/share/java/jenkins.war --webroot=%C/jenkins/war --httpPort=8080<br>root       8673  0.0  0.0 112824   980 pts/0    R+   11:20   0:00 grep --color=auto jenkins<br></code></pre></td></tr></table></figure>

<h3 id="6、浏览器访问Jenkins界面"><a href="#6、浏览器访问Jenkins界面" class="headerlink" title="6、浏览器访问Jenkins界面"></a>6、浏览器访问Jenkins界面</h3><p><a target="_blank" rel="noopener" href="http://192.168.2.202:8080/login">http://192.168.2.202:8080/login</a> </p>
<p>Jenkins正在配置启动中，比较慢，注意给够配置资源</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]# cat /var/lib/jenkins/secrets/initialAdminPassword   #找到初始密码<br>905de696e91543139f67d2c551571e65<br></code></pre></td></tr></table></figure>

<p><img src="/img/post/Jenkins/Jenkins1.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="7、-选择插件来安装"><a href="#7、-选择插件来安装" class="headerlink" title="7、 选择插件来安装"></a>7、 选择插件来安装</h3><p><img src="/img/post/Jenkins/Jenkins2.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="8、选择“无”"><a href="#8、选择“无”" class="headerlink" title="8、选择“无”"></a>8、选择“无”</h3><p><img src="/img/post/Jenkins/Jenkins3.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="9、创建管理员用户"><a href="#9、创建管理员用户" class="headerlink" title="9、创建管理员用户"></a>9、创建管理员用户</h3><p><img src="/img/post/Jenkins/Jenkins4.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="10、配置国内插件地址"><a href="#10、配置国内插件地址" class="headerlink" title="10、配置国内插件地址"></a>10、配置国内插件地址</h3><p>选择安装插件路径Manage Jenkins—Manage Plugins—Plugin Manager—Advanced然后下拉到底</p>
<p><img src="/img/post/Jenkins/Jenkins5.jpg" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]# cd /var/lib/jenkins/updates<br>[root@jenkins updates]# ls<br>default.json  hudson.tasks.Maven.MavenInstaller<br>[root@jenkins updates]# sed -i &#x27;s/http:\/\/updates.jenkinsci.org\/download/https:\/\/mirrors.tuna.tsinghua.edu.cn\/jenkins/g&#x27; default.json &amp;&amp; sed -i &#x27;s/http:\/\/www.google.com/https:\/\/www.baidu.com/g&#x27; default.json<br>[root@jenkins updates]# systemctl restart jenkins.service<br></code></pre></td></tr></table></figure>

<p><img src="/img/post/Jenkins/Jenkins6.jpg" srcset="/img/loading.gif" lazyload></p>
<p>也可以先装中文包（虽然效果等于无）</p>
<p><img src="/img/post/Jenkins/Jenkins7.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="11、安装插件"><a href="#11、安装插件" class="headerlink" title="11、安装插件"></a>11、安装插件</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">安装<span class="hljs-keyword">jenkins所需插件</span><br><span class="hljs-keyword"></span>Credentials                <span class="hljs-comment"># 签名证书管理插件</span><br>Gitlab                     <span class="hljs-comment"># 安装后从 GitLab 获取代码</span><br>Git    和 Git Client       <span class="hljs-comment"># 用于 Jenkins 在 GitLab 中拉取源码                </span><br>Gitlab Authentication      <span class="hljs-comment"># GitLab 和 Jenkins 认证插件</span><br>maven              <br>chinese                    <span class="hljs-comment">#中文插件</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/post/Jenkins/Jenkins8.jpg" srcset="/img/loading.gif" lazyload>需要一个漫长的等待，安装完插件后重启Jenkins</p>
<p><img src="/img/post/Jenkins/Jenkins9.jpg" srcset="/img/loading.gif" lazyload></p>
<p><u><strong>后因插件兼容性，升级到2.405</strong></u></p>
<h3 id="12、生成公钥私钥对出来"><a href="#12、生成公钥私钥对出来" class="headerlink" title="12、生成公钥私钥对出来"></a>12、生成公钥私钥对出来</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]# ssh-keygen  #无特殊就一路回车到底<br>Generating public/private rsa key pair.<br>Enter file in which to save the key (/root/.ssh/id_rsa): <br>Created directory &#x27;/root/.ssh&#x27;.<br>Enter passphrase (empty for no passphrase): <br>Enter same passphrase again: <br>Your identification has been saved in /root/.ssh/id_rsa.<br>Your public key has been saved in /root/.ssh/id_rsa.pub.<br>The key fingerprint is:<br>SHA256:+bfnTrwGlXZq2vRA8W3ucB+WiqT0aot0ESQNncVm5KE root@jenkins<br>The key&#x27;s randomart image is:<br>+---[RSA 2048]----+<br>|       o+.=+     |<br>|        o+o+. .  |<br>|         Eo.   +.|<br>|         ..   = =|<br>|        S.   + =.|<br>|         o....*+o|<br>|       ...= o*=*o|<br>|      . oo +.++.+|<br>|       ..oo .=+  |<br>+----[SHA256]-----+<br></code></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@jenkins ~]# ls /root/.ssh/<br>id_rsa  id_rsa.pub<br></code></pre></td></tr></table></figure>

<h3 id="13、在Jenkins配置凭据"><a href="#13、在Jenkins配置凭据" class="headerlink" title="13、在Jenkins配置凭据"></a>13、在Jenkins配置凭据</h3><p><img src="/img/post/Jenkins/Jenkins10.jpg" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/post/Jenkins/Jenkins11.jpg" srcset="/img/loading.gif" lazyload>14、添加JDK，Git，Maven，路径</p>
<p><img src="/img/post/Jenkins/Jenkins12.jpg" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/post/Jenkins/Jenkins13.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="注：JDK配置路径不识别解决"><a href="#注：JDK配置路径不识别解决" class="headerlink" title="注：JDK配置路径不识别解决"></a>注：JDK配置路径不识别解决</h3><p>部署Jenkins（version：2.405）时，全局新装Java-11。虽然centos7.9自带1.8.0，但在Jenkins配置JDK目录是不识别的。</p>
<p>解决方法：官网下载JDK1.8.0包解压放置指定目录</p>
<h1 id="二、开始gitlab安装配置"><a href="#二、开始gitlab安装配置" class="headerlink" title="二、开始gitlab安装配置"></a>二、开始gitlab安装配置</h1><h3 id="1、配置yum源地址"><a href="#1、配置yum源地址" class="headerlink" title="1、配置yum源地址"></a>1、配置yum源地址</h3><p>注：建议换腾讯源。官方源和清华源速度上不去。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/yum.repos.d/gitlab-ce.repo<br>[gitlab-ce]<br>name=Gitlab CE Repository<br>baseurl=https://mirrors.cloud.tencent.com/gitlab-ce/yum/el$releasever/<br>gpgcheck=0<br>enabled=1<br></code></pre></td></tr></table></figure>

<p>或者用wget安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget --no-check-certificate https://mirrors.cloud.tencent.com/gitlab-ce/yum/el7/gitlab-ce-15.9.8-ce.0.el7.x86_64.rpm<br></code></pre></td></tr></table></figure>

<h3 id="2、启动postfix邮件服务"><a href="#2、启动postfix邮件服务" class="headerlink" title="2、启动postfix邮件服务"></a>2、启动postfix邮件服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cobol">systemctl start postfix<br>systemctl enable  postfix<br></code></pre></td></tr></table></figure>

<h3 id="3、修改配置文件"><a href="#3、修改配置文件" class="headerlink" title="3、修改配置文件"></a>3、修改配置文件</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">vi /etc/gitlab/gitlab.rb<br>-------------------------------------------<br>external_url &#x27;http://your_ip:your_port&#x27;<br>nginx[&#x27;listen_port&#x27;] = your_port<br></code></pre></td></tr></table></figure>

<h3 id="4、加载初始化命令执行"><a href="#4、加载初始化命令执行" class="headerlink" title="4、加载初始化命令执行"></a>4、加载初始化命令执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@gitlab ~]# gitlab-ctl reconfigure  #漫长的等待<br></code></pre></td></tr></table></figure>

<h3 id="5、确认gitlab启动情况"><a href="#5、确认gitlab启动情况" class="headerlink" title="5、确认gitlab启动情况"></a>5、确认gitlab启动情况</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@gitlab ~]# gitlab-ctl start<br>ok: run: alertmanager: (pid 10489) 26s<br>ok: run: gitaly: (pid 10428) 36s<br>ok: run: gitlab-exporter: (pid 10466) 27s<br>ok: run: gitlab-kas: (pid 10444) 29s<br>ok: run: gitlab-workhorse: (pid 10453) 29s<br>ok: run: logrotate: (pid 9274) 658s<br>ok: run: nginx: (pid 10095) 87s<br>ok: run: node-exporter: (pid 10461) 28s<br>ok: run: postgres-exporter: (pid 10498) 25s<br>ok: run: postgresql: (pid 9798) 142s<br>ok: run: prometheus: (pid 10474) 27s<br>ok: run: puma: (pid 9998) 105s<br>ok: run: redis: (pid 9642) 154s<br>ok: run: redis-exporter: (pid 10468) 27s<br>ok: run: sidekiq: (pid 10019) 99s<br></code></pre></td></tr></table></figure>

<h3 id="6、取得默认密码-账号：root"><a href="#6、取得默认密码-账号：root" class="headerlink" title="6、取得默认密码  账号：root"></a>6、取得默认密码  账号：root</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@gitlab ~]# cat  /etc/gitlab/initial_root_password<br><span class="hljs-meta prompt_"># </span><span class="language-bash">WARNING: This value is valid only <span class="hljs-keyword">in</span> the following conditions</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">         1. If provided manually (either via `GITLAB_ROOT_PASSWORD` environment variable or via `gitlab_rails[<span class="hljs-string">&#x27;initial_root_password&#x27;</span>]` setting <span class="hljs-keyword">in</span> `gitlab.rb`, it was provided before database was seeded <span class="hljs-keyword">for</span> the first time (usually, the first reconfigure run).</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">         2. Password hasn<span class="hljs-string">&#x27;t been changed manually, either via UI or via command line.</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-string"></span></span><br><span class="hljs-string"><span class="language-bash">#          If the password shown here doesn&#x27;</span>t work, you must reset the admin password following https://docs.gitlab.com/ee/security/reset_user_password.html<span class="hljs-comment">#reset-your-root-password.</span></span><br>Password: rJ1tJAQxmWLdHIQWDk85TV4os9tAmnagsfDOv0D5cvk=<br></code></pre></td></tr></table></figure>

<h3 id="7、登录"><a href="#7、登录" class="headerlink" title="7、登录"></a>7、登录</h3><p><a href="http://your_ip:your_port">http://your_ip:your_port</a></p>
<p><img src="/img/post/Jenkins/gitlab1.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="8、修改页面语言"><a href="#8、修改页面语言" class="headerlink" title="8、修改页面语言"></a>8、修改页面语言</h3><p><img src="/img/post/Jenkins/gitlab2.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="9、修改初始密码"><a href="#9、修改初始密码" class="headerlink" title="9、修改初始密码"></a>9、修改初始密码</h3><p><img src="/img/post/Jenkins/gitlab3.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="10、创建测试项目"><a href="#10、创建测试项目" class="headerlink" title="10、创建测试项目"></a>10、创建测试项目</h3><p><img src="/img/post/Jenkins/gitlab4.jpg" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/post/Jenkins/gitlab5.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="11、配置SSH密钥"><a href="#11、配置SSH密钥" class="headerlink" title="11、配置SSH密钥"></a>11、配置SSH密钥</h3><p><img src="/img/post/Jenkins/gitlab6.jpg" srcset="/img/loading.gif" lazyload></p>
<h1 id="三、开始测试"><a href="#三、开始测试" class="headerlink" title="三、开始测试"></a>三、开始测试</h1><p><img src="/img/post/Jenkins/gitlab7.jpg" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/post/Jenkins/gitlab8.jpg" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/post/Jenkins/gitlab9.jpg" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E8%BF%90%E7%BB%B4/" class="category-chain-item">运维</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E8%BF%90%E7%BB%B4/">#运维</a>
      
        <a href="/tags/Jenkins/">#Jenkins</a>
      
        <a href="/tags/gitlab/">#gitlab</a>
      
        <a href="/tags/%E9%83%A8%E7%BD%B2/">#部署</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/05/18/script/" title="Liunx常用脚本案例">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Liunx常用脚本案例</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/05/09/truenaszfs/" title="PVE+TrueNAS+ZFS+虚拟网桥可行性方案">
                        <span class="hidden-mobile">PVE+TrueNAS+ZFS+虚拟网桥可行性方案</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
